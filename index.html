<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì í¬_í†µí•©_ìê°€ì ê²€_ë¦¬í¬íŠ¸</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root { 
            --kk-green: #004a26; 
            --kk-red: #d32f2f;   
            --kk-light: #f9f8f0; 
            --kk-shadow: rgba(0, 0, 0, 0.2);
        }

        body { font-family: 'Pretendard', sans-serif; background: var(--kk-light); margin: 0; padding: 20px; color: #333; }
        .container { max-width: 1100px; margin: auto; background: white; padding: 40px; border: 2px solid var(--kk-green); border-radius: 8px; box-shadow: 0 15px 35px var(--kk-shadow); position: relative; }
        
        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        .main-title { text-align: center; margin-bottom: 30px; }
        .main-title h1 { color: var(--kk-red); font-size: 2.8em; margin: 10px 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.1); }
        .main-title .sub { color: var(--kk-green); font-size: 1.6em; font-weight: bold; border-bottom: 4px double var(--kk-green); display: inline-block; padding-bottom: 5px; }

        /* ì •ë³´ í…Œì´ë¸” */
        .info-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; border: 2px solid var(--kk-green); }
        .info-table th { background: linear-gradient(180deg, var(--kk-green), #003a1d); color: white; padding: 12px; text-align: left; width: 15%; border: 1px solid var(--kk-green); }
        .info-table td { border: 1px solid var(--kk-green); padding: 10px; background: #fff; }
        input[type="text"], input[type="date"] { width: 100%; border: 1px solid #ddd; padding: 8px; box-sizing: border-box; border-radius: 4px; }

        /* ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .section { margin-top: 25px; display: none; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
        .section.active { display: block; }
        .section-header { background: linear-gradient(90deg, var(--kk-green), #006b38); color: white; padding: 15px 20px; font-size: 1.3em; font-weight: bold; }
        
        .list-table { width: 100%; border-collapse: collapse; background: white; }
        .list-table th { background: #f1f3f1; color: var(--kk-green); border: 1px solid var(--kk-green); padding: 12px; font-size: 1em; }
        .list-table td { border: 1px solid var(--kk-green); padding: 12px; vertical-align: middle; }
        
        .item-no { width: 45px; text-align: center; color: var(--kk-red); font-weight: 800; font-size: 1.1em; }
        .item-title { font-weight: bold; display: block; margin-bottom: 4px; }
        .item-penalty { font-size: 0.88em; color: #d32f2f; font-weight: 500; }
        
        /* ë¼ë””ì˜¤ ì˜µì…˜ ìŠ¤íƒ€ì¼ (ì¸ì‡„ ëŒ€ì‘ìš©) */
        .options-wrapper { display: flex; gap: 15px; white-space: nowrap; justify-content: center; align-items: center; }
        .options-wrapper label { font-size: 0.95em; cursor: pointer; display: flex; align-items: center; gap: 6px; font-weight: 600; }
        
        /* ë¼ë””ì˜¤ ë²„íŠ¼ ê¸°ë³¸ ë””ìì¸ ì»¤ìŠ¤í…€ (ì¸ì‡„ ì‹œ ë°°ê²½ìƒ‰ ë¬´ì‹œ ë°©ì§€) */
        .options-wrapper input[type="radio"] {
            appearance: none;
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border: 2px solid var(--kk-green);
            border-radius: 50%;
            background-color: #fff;
            position: relative;
            cursor: pointer;
            margin: 0;
        }
        .options-wrapper input[type="radio"]:checked::before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 10px;
            height: 10px;
            background-color: var(--kk-green);
            border-radius: 50%;
        }

        /* í”Œë¡œíŒ… ë²„íŠ¼ */
        .floating-group { position: fixed; bottom: 30px; right: 30px; display: flex; flex-direction: column; gap: 15px; z-index: 1000; }
        .f-btn { 
            width: 85px; height: 85px; border-radius: 50%; border: 3px solid white; color: white; 
            font-weight: bold; cursor: pointer; transition: 0.3s; font-size: 14px; 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            box-shadow: 0 8px 15px rgba(0,0,0,0.3);
        }
        .f-btn.excel { background: linear-gradient(135deg, #27ae60, #1e8449); }
        .f-btn.print { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .f-btn:hover { transform: translateY(-5px) scale(1.05); }

        .selector-box { background: #fff; border: 2px dashed var(--kk-green); padding: 20px; margin-bottom: 25px; border-radius: 8px; }

        @media print {
            .no-print { display: none !important; }
            body { background: white; padding: 0; }
            .container { border: 2px solid #000; padding: 10px; box-shadow: none; width: 100%; max-width: 100%; }
            .section { page-break-after: always; display: none; border: 1px solid #000; }
            .section.active { display: block !important; }
            .section-header { background: #f0f0f0 !important; color: black !important; border-bottom: 2px solid #000; -webkit-print-color-adjust: exact; }
            
            /* ì¸ì‡„ ì‹œ ë¼ë””ì˜¤ ë²„íŠ¼ì´ ì„ ëª…í•˜ê²Œ ë³´ì´ë„ë¡ ì„¤ì • */
            .options-wrapper input[type="radio"] {
                border: 2px solid #000 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .options-wrapper input[type="radio"]:checked::before {
                background-color: #000 !important;
            }
            .list-table td { border: 1px solid #000; }
        }
    </style>
</head>
<body>

<div class="floating-group no-print">
    <button class="f-btn excel" onclick="exportToExcel()"><span>ğŸ“Š</span>EXCEL</button>
    <button class="f-btn print" onclick="window.print()"><span>ğŸ–¨ï¸</span>PRINT</button>
</div>

<div class="container">
    <div class="main-title">
        <div class="sub">REPORT</div>
        <h1>ì í¬ í†µí•© ìê°€ì ê²€ ë¦¬í¬íŠ¸</h1>
    </div>

    <table class="info-table">
        <tr>
            <th>ì ê²€ì¼ì</th>
            <td><input type="date" id="ins_date"></td>
            <th>ì§€ì ëª…</th>
            <td><input type="text" id="branch_name" placeholder="ì§€ì ëª… ì…ë ¥"></td>
        </tr>
        <tr>
            <th>ì í¬ëª…</th>
            <td><input type="text" id="store_name" placeholder="ì í¬ëª… ì…ë ¥"></td>
            <th>ì ê²€ì</th>
            <td><input type="text" id="inspector" placeholder="ì„±í•¨ ì…ë ¥"></td>
        </tr>
    </table>

    <div class="selector-box no-print">
        <p style="margin-top:0; font-weight:bold; color:var(--kk-red);">* ì¶œë ¥ ëŒ€ìƒ ì„ íƒ (ì¢…ì´ ì ê²€ ì‹œì—ë„ ì„ íƒí•œ í•­ëª©ì´ ì¶œë ¥ë©ë‹ˆë‹¤)</p>
        <label><input type="checkbox" id="chk1" checked onchange="toggleSec('sec1', this)"> 1. ì¸ìŠ¤í™ì…˜</label>
        <label><input type="checkbox" id="chk2" checked onchange="toggleSec('sec2', this)"> 2. ESM</label>
        <label><input type="checkbox" id="chk3" checked onchange="toggleSec('sec3', this)"> 3. ë…¸ë™ë²•(ì§ì˜)</label>
        <label><input type="checkbox" id="chk4" checked onchange="toggleSec('sec4', this)"> 4. ë…¸ë™ë²•(ê°€ë§¹)</label>
    </div>

    <div id="content-area">
        <div class="section active" id="sec1">
            <div class="section-header">1. ì¸ìŠ¤í™ì…˜ (ìœ„ìƒ/ì‹œì„¤) ì ê²€</div>
            <table class="list-table">
                <thead><tr><th>No.</th><th style="width: 70%;">ì ê²€ í•­ëª© / ê¸°ì¤€</th><th>ì ê²€ ê²°ê³¼</th></tr></thead>
                <tbody id="list1"></tbody>
            </table>
        </div>
        <div class="section active" id="sec2">
            <div class="section-header">2. ESM (ì‚°ì—…ì•ˆì „/ì†Œë°©) ì ê²€</div>
            <table class="list-table">
                <thead><tr><th>No.</th><th style="width: 70%;">ì ê²€ í•­ëª© / ê¸°ì¤€</th><th>ì ê²€ ê²°ê³¼</th></tr></thead>
                <tbody id="list2"></tbody>
            </table>
        </div>
        <div class="section active" id="sec3">
            <div class="section-header">3. ë…¸ë™ê´€ê³„ë²• (ì§ì˜) ì ê²€</div>
            <table class="list-table">
                <thead><tr><th>No.</th><th style="width: 70%;">ì ê²€ í•­ëª© / ê¸°ì¤€</th><th>ì ê²€ ê²°ê³¼</th></tr></thead>
                <tbody id="list3"></tbody>
            </table>
        </div>
        <div class="section active" id="sec4">
            <div class="section-header">4. ë…¸ë™ê´€ê³„ë²• (ê°€ë§¹/ìœ„íƒ) ì ê²€</div>
            <table class="list-table">
                <thead><tr><th>No.</th><th style="width: 70%;">ì ê²€ í•­ëª© / ê¸°ì¤€</th><th>ì ê²€ ê²°ê³¼</th></tr></thead>
                <tbody id="list4"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
    // [ë°ì´í„° ìƒëµ - ì´ì „ê³¼ ë™ì¼í•˜ê²Œ 66ê°œ í•­ëª© ì „ì²´ í¬í•¨ë¨]
    const fullData = {
        inspection: [ {t: "ì›ë¶€ìì¬ ì†Œë¹„ê¸°í•œ ê²½ê³¼ ì§„ì—´, ë³´ê´€, ì‚¬ìš©, íŒë§¤, ë³€ì¡°", p: "ì˜ì—…ì •ì§€ 15ì¼"}, {t: "í›„ë¼ì‰ ì˜¤ì¼ ì‚°ê°€ ê´€ë¦¬ (ê´€ë¦¬ê¸°ì¤€ 2.0 ë¯¸ë§Œ)", p: "ì‚°ê°€ 3.0 ì´ˆê³¼: ì˜ì—…ì •ì§€ 15ì¼"}, {t: "ê±´ê°•ì§„ë‹¨ì„œ(ë³´ê±´ì¦) ë¯¸ë³´ìœ  ë° ê²€ì§„ì¼ ê¸°ì¤€ 1ë…„ ì´ˆê³¼", p: "ê³¼íƒœë£Œ 30~50ë§Œì›"}, {t: "ì˜ì—…í—ˆê°€ì¦(ì˜ì—…ì‹ ê³ ì¦) ì›ë³¸ ì í¬ ë¹„ì¹˜ ë° ë³´ê´€", p: "ê³¼íƒœë£Œ 100ë§Œì› ì´í•˜"}, {t: "ì›ì‚°ì§€ í‘œì‹œíŒ ì ì • ìš´ì˜ (ì¸µë³„/êµ¬íšë³„ ê°ê° í‘œì‹œ)", p: "ê³¼íƒœë£Œ 5~1,000ë§Œì›"}, {t: "ìœ„ìƒêµìœ¡ ìˆ˜ë£Œ ì—¬ë¶€ í™•ì¸ (ì‹ ê·œ/ë³´ìˆ˜ êµìœ¡ ì—° 1íšŒ)", p: "ê³¼íƒœë£Œ 20ë§Œì›"}, {t: "ë°©ì—­ì—…ì²´ ì†Œë…í•„ì¦ ë° ì„œë¹„ìŠ¤ ë¦¬í¬íŠ¸ ì„œë¥˜ ê´€ë¦¬", p: "ê³¼íƒœë£Œ 100ë§Œì›"}, {t: "ì œí’ˆë³„ ì˜ì–‘ì„±ë¶„ ë° ì•Œë ˆë¥´ê¸° ìœ ë°œì‹í’ˆ ì•ˆë‚´ ê²Œì‹œ", p: "ê³¼íƒœë£Œ 100ë§Œì›"}, {t: "ê±°ë˜ëª…ì„¸ì„œ(ì§/ë°°ì†¡) ë“± ë²•ì ê¸°ì¤€ ì„œë¥˜ ë³´ê´€", p: "ê³¼íƒœë£Œ 20ë§Œì›"}, {t: "ì›ì¬ë£Œ ë° ì‹í’ˆ í‘œì‹œì‚¬í•­ ì‹ë³„ ê´€ë¦¬ (ì†Œë¶„ ê´€ë¦¬)", p: "ì˜ì—…ì •ì§€ 1ê°œì›”"}, {t: "ë°˜í’ˆ/íê¸°ìƒí’ˆ ë° êµìœ¡ìš© í‘œì‹œ ëª…í™•í™”", p: "ê´€ë¦¬ ë¯¸í¡ ì‹œ ì‹œì •ëª…ë ¹"}, {t: "ì‹ì¬ë£Œ ì´ê²© ê´€ë¦¬ (ë°”ë‹¥ì—ì„œ 15cm ì´ìƒ)", p: "ê³¼íƒœë£Œ 100ë§Œì›"}, {t: "ì›ì¬ë£Œ/ì™„ì œí’ˆ ë³´ê´€ì˜¨ë„ ì¤€ìˆ˜ (ëƒ‰ì¥ 10ë„, ëƒ‰ë™ -18ë„)", p: "ì˜ì—…ì •ì§€ 7ì¼"}, {t: "í—ˆìš©ëœ ì‹í’ˆì²¨ê°€ë¬¼ ì‚¬ìš© ë° ë³´ê´€ ì¤€ìˆ˜", p: "ì˜ì—…ì •ì§€ 15ì¼"}, {t: "í•´ë™ ë°©ë²• ì¤€ìˆ˜ (ì‹¤ì˜¨í•´ë™ ê¸ˆì§€, í•´ë™ë¼ë²¨ ë¶€ì°©)", p: "ì˜ì—…ì •ì§€ 7ì¼"}, {t: "ì¹¼, ë„ë§ˆ, ì‹ê¸°ë¥˜ ë“± ì‹í’ˆì ‘ì´‰ë„êµ¬ ìœ„ìƒì  ì·¨ê¸‰", p: "ê³¼íƒœë£Œ 50ë§Œì›"}, {t: "ë°”ë‹¥, ë°°ìˆ˜êµ¬, í™˜ê¸°êµ¬, í›„ë“œ ì²­ê²° ë° ê¸°ë¦„ë•Œ ê´€ë¦¬", p: "ê³¼íƒœë£Œ 50ë§Œì›"}, {t: "ì œë¹™ê¸° ìœ„ìƒ ê´€ë¦¬ ë° í´ë¦¬ë‹ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì‘ì„±", p: "ê³¼íƒœë£Œ 50ë§Œì›"}, {t: "ìœ„ìƒëª¨, ë§ˆìŠ¤í¬ ì°©ìš© ë° ê°œì¸ ì•¡ì„¸ì„œë¦¬ ì°©ìš© ê¸ˆì§€", p: "ê³¼íƒœë£Œ 20ë§Œì›"}, {t: "ê·¼ë¬´ì ì† ìƒì²˜(í™”ë†ì„± ì§ˆí™˜) ê´€ë¦¬ ë° ì¥ê°‘ ì°©ìš©", p: "êµì°¨ì˜¤ì—¼ ë°©ì§€"}, {t: "ì“°ë ˆê¸°í†µ ë®ê°œ ì‚¬ìš© ë° ìŒì‹ë¬¼ íê¸°ë¬¼ ì ì • ê´€ë¦¬", p: "ì‹œì„¤ê°œìˆ˜ëª…ë ¹"} ],
        esm: [ {t: "ê´€ë¦¬ê°ë…ì ì„ ì„ ë° ìì²´ ì„ ì„ì„œ/ì„ëª…ì¥ êµ¬ë¹„ (ì§ì˜)", p: "ì‚°ì—…ì•ˆì „ë³´ê±´ë²• ì œ15ì¡°"}, {t: "ê´€ë¦¬ê°ë…ì êµìœ¡ ì´ìˆ˜ í™•ì¸ (ì—° 16ì‹œê°„ ì¤€ìˆ˜)", p: "ì‚°ì—…ì•ˆì „ë³´ê±´ë²• ì œ26ì¡°"}, {t: "ê´€ë¦¬ê°ë…ì ì›” 1íšŒ ì•ˆì „ì ê²€ ì‹¤ì‹œ (ESM ì´ìš©)", p: "ì „ ì í¬ ê³µí†µ"}, {t: "ì•ˆì „ë³´ê±´ê´€ë¦¬ê·œì • ì í¬ ë‚´ ë³´ê´€ (PC/ì„œë©´)", p: "ì§ì˜ ì „ ì í¬"}, {t: "ì •ê¸°ì•ˆì „ë³´ê±´êµìœ¡ (ë¶„ê¸° 6ì‹œê°„) ì‹¤ì‹œ ë° ê¸°ë¡", p: "ì§ì˜/ê°€ë§¹ 5ì¸â†‘"}, {t: "ì±„ìš© ì‹œ ì•ˆì „êµìœ¡ (8ì‹œê°„) ì‹¤ì‹œ ë° ì´ìˆ˜ì¦ ë³´ê´€", p: "ì§ì˜/ê°€ë§¹ 5ì¸â†‘"}, {t: "ì‚°ì—…ì•ˆì „ë³´ê±´ë²•ë ¹ ìš”ì§€ ê²Œì‹œíŒ ê²Œì‹œ ìƒíƒœ", p: "ì „ ì í¬"}, {t: "3ì¼ ì´ìƒ íœ´ì—… ì‚¬ê³  ì‹œ ì‚°ì—…ì¬í•´ì¡°ì‚¬í‘œ ì œì¶œ ì—¬ë¶€", p: "ìµœê·¼ 3ë…„ ë‚´"}, {t: "ë§¤ë…„ ìœ„í—˜ì„±í‰ê°€ ì‹¤ì‹œ ë° 3ë…„ì¹˜ ë³´ê´€", p: "ì „ ì í¬"}, {t: "ì•ˆì „ë³´ê±´í‘œì§€(í™”ìƒ, ë² ì„, ë¯¸ë„ëŸ¼ ë“±) ë¶€ì°© ë° í›¼ì† í™•ì¸", p: "ì „ ì í¬"}, {t: "ê·¼ê³¨ê²©ê³„ìœ í•´ìš”ì¸ì¡°ì‚¬ ì‹¤ì‹œ (3ë…„ ì£¼ê¸°)", p: "ì „ ì í¬"}, {t: "ê³ ê° í­ì–¸ ì˜ˆë°© ë¬¸êµ¬/í¬ìŠ¤í„° ê²Œì‹œ", p: "ì „ ì í¬"}, {t: "MSDS ë³´ê´€ ë° ì†Œë¶„ìš©ê¸° ê²½ê³ í‘œì§€ ë¶€ì°©", p: "ì „ ì í¬"}, {t: "ë³´í˜¸êµ¬ ì§€ê¸‰ëŒ€ì¥ ì‘ì„± ë° ì ì • ë³´í˜¸êµ¬ ë¹„ì¹˜", p: "ì „ ì í¬"}, {t: "íƒ„ì‚°ê°€ìŠ¤ìš©ê¸° ì „ë„ë°©ì§€ ì¡°ì¹˜ (ì²´ì¸/ê³ ì • ì¥ì¹˜)", p: "ì „ ì í¬"}, {t: "ì‚¬ë‹¤ë¦¬ ì•„ì›ƒíŠ¸ë¦¬ê±° ì„¤ì¹˜ ë° ì•ˆì „ ì‚¬ìš© ì¤€ìˆ˜", p: "ì „ ì í¬"}, {t: "ê°€ìŠ¤ ëˆ„ì„¤ ê²½ë³´ê¸° ë° í™”ì¬ ê°ì§€ê¸° ì‘ë™ í™•ì¸", p: "ì†Œë°©ì‹œì„¤ë²•"}, {t: "Kê¸‰ ì†Œí™”ê¸° ë¹„ì¹˜ ë° ë¶„ë§ì†Œí™”ê¸° ì—°í•œ(10ë…„) í™•ì¸", p: "í›„ë¼ì´ì–´ ì¸ê·¼"}, {t: "íœ´ëŒ€ìš© ë¹„ìƒì¡°ëª…ë“± ë° í”¼ë‚œêµ¬ ìœ ë„ë“± ì ë“± í™•ì¸", p: "ì†Œë°©ì‹œì„¤ë²•"}, {t: "ë•íŠ¸ ì²­ì†Œ ì‹œí–‰ ì—¬ë¶€ ë° í•„í„° ì²­ê²° ìƒíƒœ", p: "í™”ì¬ ì˜ˆë°©"}, {t: "ë¼ì´ë” ë©´í—ˆ í™•ì¸ ë° ë°”ì´í¬ ì •ê¸°ê²€ì‚¬ ì‹¤ì‹œ", p: "ìì²´ê³ ìš© ì í¬"} ],
        labor_direct: [ {t: "ì±„ìš© ì‹œ ì„±ë³„/ì—°ë ¹ ì°¨ë³„ ë¬¸êµ¬ ê¸°ì¬ ì—¬ë¶€", p: "ë²Œê¸ˆ 500ë§Œì›"}, {t: "ì±„ìš©ê³µê³  ë‚´ 'ì±„ìš©ì„œë¥˜ ë°˜í™˜ ì•ˆë‚´' ë¬¸êµ¬ í¬í•¨", p: "ê³¼íƒœë£Œ 300ë§Œì›"}, {t: "ì‹ ê·œ/ê°±ì‹  ê·¼ë¡œê³„ì•½ì„œ ì‘ì„± ë° ì¦‰ì‹œ êµë¶€", p: "ë²Œê¸ˆ 500ë§Œì›"}, {t: "ê·¼ë¡œìëª…ë¶€ ì‘ì„± ë° ë²•ì • í•„ìˆ˜ ì„œë¥˜ êµ¬ë¹„", p: "ë²Œê¸ˆ 500ë§Œì›"}, {t: "ì—°ì†Œì ì¹œê¶Œì ë™ì˜ì„œ ë° ì•¼ê°„/íœ´ì¼ê·¼ë¡œ ì¸ê°€", p: "ë²Œê¸ˆ 500ë§Œì›"}, {t: "ì£¼ ê·¼ë¬´ ê³„íší‘œ ë§¤ì£¼ ì‘ì„± ë° 3ë…„ ë³´ê´€", p: "ê·¼íƒœ ê´€ë¦¬"}, {t: "ì§€ê°/ê²°ê·¼/ì¡°í‡´ ì‹œ ê·¼ë¡œì í™•ì¸ ì„œëª… ê´€ë¦¬", p: "ê·¼íƒœ ì¦ë¹™"}, {t: "ì—°ì¥ê·¼ë¡œ í•œë„ ì¤€ìˆ˜ (ì„±ì¸ 12h, ì—°ì†Œì 5h ì´ˆê³¼ ê¸ˆì§€)", p: "ì§•ì—­ 2ë…„/ë²Œê¸ˆ 2ì²œ"}, {t: "íœ´ê°€/ì„ê¸ˆëŒ€ì¥/ì„ê¸ˆëª…ì„¸ì„œ ì ë²• ê´€ë¦¬ ë° êµë¶€", p: "ê³¼íƒœë£Œ 500ë§Œì›"}, {t: "íœ´ê²Œì‹œê°„ ë¶€ì—¬ ì¤€ìˆ˜ (4ì‹œê°„ë‹¹ 30ë¶„ ììœ  ì‚¬ìš©)", p: "ì§•ì—­ 2ë…„/ë²Œê¸ˆ 2ì²œ"}, {t: "ì„ì‹  ì¤‘/ì‚°í›„ 1ë…„ ê·¼ë¡œì ì—°ì¥/ì•¼ê°„ê·¼ë¡œ ì œí•œ", p: "ëª¨ì„±ë³´í˜¸"}, {t: "ì„±í¬ë¡±ì˜ˆë°©/ì¥ì• ì¸ì¸ì‹ê°œì„  êµìœ¡ì¼ì§€ 3ë…„ ë³´ê´€", p: "ë²•ì •êµìœ¡"}, {t: "ìµœì €ì„ê¸ˆ ê²Œì‹œ ë° ê·¼ë¡œê¸°ì¤€ë²•ë ¹ ìš”ì§€ ê²Œì‹œ", p: "ê³¼íƒœë£Œ 500ë§Œì›"}, {t: "í‡´ì§ê¸ˆ 14ì¼ ì´ë‚´ ì§€ê¸‰ ë° ë¯¸ì‚¬ìš© ì—°ì°¨ ì •ì‚°", p: "í‡´ì‚¬ì ê´€ë¦¬"}, {t: "ì·¨ì—…ê·œì¹™ ì í¬ ë¹„ì¹˜ ë° ë³€ê²½ ì‹œ ì ˆì°¨ ì¤€ìˆ˜", p: "ê³¼íƒœë£Œ 500ë§Œì›"} ],
        labor_franchise: [ {t: "ê·¼ë¡œê³„ì•½ì„œ ì‘ì„±/êµë¶€ ë° ê³„ì•½ê¸°ê°„ í™•ì¸", p: "ë²Œê¸ˆ 500ë§Œì›"}, {t: "ëª¨ë“  ê·¼ë¡œì ê·¼ë¡œìëª…ë¶€ ì‘ì„± ë° ë³´ê´€", p: "ê³¼íƒœë£Œ 500ë§Œì›"}, {t: "ì£¼íœ´ìˆ˜ë‹¹ ë° ì—°ì¥/ì•¼ê°„ ê°€ì‚° ìˆ˜ë‹¹(5ì¸â†‘) ì§€ê¸‰", p: "ì„ê¸ˆ ì²´ë¶ˆ ë°©ì§€"}, {t: "ì—°ì°¨ìœ ê¸‰íœ´ê°€ ë¶€ì—¬ ë° ë¯¸ì‚¬ìš© ìˆ˜ë‹¹ ì§€ê¸‰ (5ì¸â†‘)", p: "ê·¼ë¡œê¸°ì¤€ë²•"}, {t: "ëª¨ë“  ê·¼ë¡œì ìµœì €ì„ê¸ˆ ì´ìƒ ì§€ê¸‰", p: "ì§•ì—­ 3ë…„/ë²Œê¸ˆ 2ì²œ"}, {t: "íœ´ê²Œì‹œê°„ ì ì • ë¶€ì—¬ ë° ê¸°ë¡ ê´€ë¦¬", p: "ì§•ì—­ 2ë…„/ë²Œê¸ˆ 2ì²œ"}, {t: "ì„±í¬ë¡±ì˜ˆë°©êµìœ¡/ì¥ì• ì¸ì¸ì‹ê°œì„  êµìœ¡ ì¼ì§€ ë³´ê´€", p: "ì—° 1íšŒ"}, {t: "ì‚¬ì§ì› ë° ë¬´ë‹¨ê²°ê·¼ ì¦ë¹™ ì„œë¥˜ ì‘ì„± ë° ë³´ê´€", p: "ê³¼íƒœë£Œ 500ë§Œì›"}, {t: "í‡´ì§ê¸ˆ 1ë…„ ì´ìƒ ê·¼ë¬´ì ì§€ê¸‰ ì—¬ë¶€ í™•ì¸", p: "í‰ê· ì„ê¸ˆ ì‚°ì • ì¤€ìˆ˜"}, {t: "ì„ê¸ˆëª…ì„¸ì„œ êµë¶€ (ê³„ì‚°ë°©ë²• ë“± í•„ìˆ˜í•­ëª© í¬í•¨)", p: "ê³¼íƒœë£Œ 500ë§Œì›"}, {t: "ê·¼ë¡œê¸°ì¤€ë²•ë ¹ ìš”ì§€ ë° ìµœì €ì„ê¸ˆ ê²Œì‹œ ì—¬ë¶€", p: "ê³¼íƒœë£Œ 500ë§Œì›"}, {t: "ì—°ì†Œì ê·¼ë¡œ ì‹œ ê´€ë ¨ ë²•ì  ì¦ë¹™ì„œë¥˜ ë¹„ì¹˜", p: "í•´ë‹¹ ì í¬"}, {t: "í•´ê³  30ì¼ ì „ ì˜ˆê³  ì¤€ìˆ˜ ë˜ëŠ” ì˜ˆê³ ìˆ˜ë‹¹ ì§€ê¸‰", p: "ë²Œê¸ˆí˜•"}, {t: "ì£¼ ê·¼ë¬´ ê³„íší‘œ ë³´ê´€ ë° ì‹¤ì œ ê·¼íƒœ ëŒ€ì¡°", p: "ê¸°ë³¸ ê·¼íƒœ ê´€ë¦¬"}, {t: "ì·¨ì—…ê·œì¹™ ê²Œì‹œ (ìƒì‹œê·¼ë¡œì 10ì¸ ì´ìƒ)", p: "ê³¼íƒœë£Œ 500ë§Œì›"} ]
    };

    function renderItems(targetId, items) {
        const target = document.getElementById(targetId);
        items.forEach((item, idx) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td class="item-no">${idx + 1}</td>
                <td>
                    <span class="item-title">${item.t}</span>
                    <span class="item-penalty">â€» ë²•ê·œ/ê¸°ì¤€: ${item.p}</span>
                </td>
                <td>
                    <div class="options-wrapper">
                        <label><input type="radio" name="${targetId}_${idx}" value="ì–‘í˜¸"> ì–‘í˜¸</label>
                        <label><input type="radio" name="${targetId}_${idx}" value="ë¶ˆëŸ‰"> ë¶ˆëŸ‰</label>
                        <label><input type="radio" name="${targetId}_${idx}" value="N/A"> N/A</label>
                    </div>
                </td>
            `;
            target.appendChild(row);
        });
    }

    function toggleSec(id, cb) {
        document.getElementById(id).classList.toggle('active', cb.checked);
    }

    function exportToExcel() {
        const store = document.getElementById('store_name').value || "ì í¬ëª…";
        const inspector = document.getElementById('inspector').value || "ì„±í•¨";
        const date = document.getElementById('ins_date').value || "ë‚ ì§œ";
        
        let aoa = [
            ["ì í¬ í†µí•© ìê°€ì ê²€ ë¦¬í¬íŠ¸"],
            ["ì ê²€ì¼ì", date, "ì§€ì ëª…", document.getElementById('branch_name').value],
            ["ì í¬ëª…", store, "ì ê²€ì", inspector],
            [],
            ["No.", "ì ê²€ í•­ëª©", "ë²•ê·œ ë° ê´€ë¦¬ ê¸°ì¤€", "ì ê²€ ê²°ê³¼"]
        ];

        const sections = [
            { id: 'sec1', title: '1. ì¸ìŠ¤í™ì…˜ (ìœ„ìƒ/ì‹œì„¤)', data: 'inspection' },
            { id: 'sec2', title: '2. ESM (ì‚°ì—…ì•ˆì „/ì†Œë°©)', data: 'esm' },
            { id: 'sec3', title: '3. ë…¸ë™ê´€ê³„ë²• (ì§ì˜)', data: 'labor_direct' },
            { id: 'sec4', title: '4. ë…¸ë™ê´€ê³„ë²• (ê°€ë§¹)', data: 'labor_franchise' }
        ];

        sections.forEach(sec => {
            if (document.getElementById(sec.id).classList.contains('active')) {
                aoa.push([sec.title, "", "", ""]);
                fullData[sec.data].forEach((item, idx) => {
                    const radios = document.getElementsByName(`${sec.id.replace('sec', 'list')}_${idx}`);
                    let res = "-";
                    radios.forEach(r => { if(r.checked) res = r.value; });
                    aoa.push([idx + 1, item.t, item.p, res]);
                });
                aoa.push([]); 
            }
        });

        const ws = XLSX.utils.aoa_to_sheet(aoa);
        ws['!cols'] = [{wch: 6}, {wch: 55}, {wch: 45}, {wch: 12}];
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "ìê°€ì ê²€ê²°ê³¼");
        XLSX.writeFile(wb, `${store}_${inspector}_${date}.xlsx`);
    }

    renderItems('list1', fullData.inspection);
    renderItems('list2', fullData.esm);
    renderItems('list3', fullData.labor_direct);
    renderItems('list4', fullData.labor_franchise);
</script>

</body>
</html>